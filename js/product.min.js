import"./app.min.js";import"./input.min.js";import"./unimodal.min.js";import"./swiper-core.min.js";document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector(".popular-section__items")||document.querySelector(".testimonials-slider")||document.querySelector(".articles-slider")||document.querySelector("[data-fls-slider]"),t=document.querySelector(".product-grid")||document.querySelector("#productItems")||document.querySelector(".product-grid__items");if(e&&!t){console.log("\u{1F6AB} \u0421\u043B\u0430\u0439\u0434\u0435\u0440\u043D\u0430 \u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0430 \u0432\u0438\u044F\u0432\u043B\u0435\u043D\u0430 - \u043F\u0440\u043E\u0434\u0443\u043A\u0442\u043E\u0432\u0438\u0439 \u0441\u043A\u0440\u0438\u043F\u0442 \u043F\u0440\u043E\u043F\u0443\u0449\u0435\u043D\u0438\u0439");return}if(!t){console.log("\u2139\uFE0F \u041F\u0440\u043E\u0434\u0443\u043A\u0442\u043E\u0432\u0430 \u0441\u0456\u0442\u043A\u0430 \u043D\u0435 \u0437\u043D\u0430\u0439\u0434\u0435\u043D\u0430 - \u0441\u043A\u0440\u0438\u043F\u0442 \u043F\u0440\u043E\u043F\u0443\u0449\u0435\u043D\u0438\u0439");return}console.log("\u2705 \u0406\u043D\u0456\u0446\u0456\u0430\u043B\u0456\u0437\u0430\u0446\u0456\u044F \u043F\u0440\u043E\u0434\u0443\u043A\u0442\u043E\u0432\u043E\u0457 \u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0438...")});let g=[],l=[],i=1;const p=9;let S="default",r={categories:[],priceRanges:[]};const c=document.getElementById("productItems"),E=document.getElementById("totalCount"),y=document.getElementById("pagination"),u=document.getElementById("filterBtn"),f=document.getElementById("filterPanel"),m=document.getElementById("sortBtn"),a=document.getElementById("sortPanel");function q(e){return{id:parseInt(e.dataset.id),name:e.dataset.name,category:e.dataset.category,price:parseFloat(e.dataset.price),description:e.dataset.description,slug:e.dataset.slug,element:e}}function C(){const e=new URLSearchParams(window.location.search);return{search:e.get("search")||"",category:e.get("category")||"",priceRange:e.get("priceRange")||""}}function h(e=""){const t=new URL(window.location);e?t.searchParams.set("search",e):t.searchParams.delete("search"),window.history.replaceState({},"",t)}function b(e,t){let s=document.getElementById("searchMessage");if(s||(s=document.createElement("div"),s.id="searchMessage",s.className="search-message",c&&c.parentNode.insertBefore(s,c)),e){const n=t===1?"result":"results";s.innerHTML=`
      <p>Search results for: "<strong>${e}</strong>"  
          <span class="results-count">(${t} ${n} found)</span>
          <button class="clear-search-btn" onclick="clearSearch()">\u2716 Clear search</button>
      </p>
    `,s.style.display="block"}else s.style.display="none"}window.clearSearch=function(){const e=document.querySelector(".search-form__input");e&&(e.value=""),d(""),h();const t=document.getElementById("searchMessage");t&&(t.style.display="none")};function k(e){const t=e.value;let s=!0;const n=t.replace(/[^A-Za-zА-Яа-я0-9\s\-]/g,"");n!==t&&(e.value=n),n.length>0&&n.length<3?s=!1:n.length>80&&(e.value=n.substring(0,80),s=!0);const o=document.querySelector(".search-form__button");return o&&(o.disabled=!s||n.length<3),s}function B(){const e=document.querySelector(".product-grid__search"),t=document.getElementById("productItems"),s=document.getElementById("searchMessage");let n=null;s&&s.style.display!=="none"?n=s:e?n=e:t&&(n=t),n&&setTimeout(()=>{n.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),setTimeout(()=>{const I=n.getBoundingClientRect().top+window.pageYOffset+-20;window.scrollTo({top:I,behavior:"smooth"})},300)},100)}function M(){const e=document.querySelector(".search-form__input"),t=document.querySelector(".search-form");e&&t&&(e.addEventListener("input",function(s){if(k(s.target),s.target.value.length>=3){const n=s.target.value.toLowerCase();d(n),h(n)}else s.target.value.length===0&&(d(""),h())}),t.addEventListener("submit",function(s){s.preventDefault();const n=e.value.trim();n.length>=3&&(d(n.toLowerCase()),h(n))})),u&&f&&(u.addEventListener("click",P),document.addEventListener("click",T),document.querySelectorAll('.filter-option input[type="checkbox"]').forEach(s=>{s.addEventListener("change",_)})),m&&a&&(m.addEventListener("click",R),document.querySelectorAll(".sort-option").forEach(s=>{s.addEventListener("click",$)}))}function P(){f.classList.toggle("active"),u.classList.toggle("active"),a&&a.classList.remove("active")}function _(e){const t=e.target.value,s=e.target.checked;["Chair","Table","Cupboard","Decoration"].includes(t)?s?r.categories.push(t):r.categories=r.categories.filter(n=>n!==t):s?r.priceRanges.push(t):r.priceRanges=r.priceRanges.filter(n=>n!==t),d()}function R(){a&&(a.classList.toggle("active"),f.classList.remove("active"),u.classList.remove("active"))}function $(e){S=e.target.dataset.sort,document.querySelectorAll(".sort-option").forEach(s=>{s.classList.remove("active")}),e.target.classList.add("active"),d(),a&&a.classList.remove("active")}function T(e){u&&f&&!u.contains(e.target)&&!f.contains(e.target)&&(f.classList.remove("active"),u.classList.remove("active")),m&&a&&!m.contains(e.target)&&!a.contains(e.target)&&a.classList.remove("active")}function d(e=""){if(!e){const n=document.querySelector(".search-form__input");e=n?n.value.toLowerCase():""}let t=g.map(q);const s=e;switch(e&&e.length>=3&&(t=t.filter(n=>n.name.toLowerCase().includes(e)||n.category.toLowerCase().includes(e)||n.description.toLowerCase().includes(e))),r.categories.length>0&&(t=t.filter(n=>r.categories.includes(n.category))),r.priceRanges.length>0&&(t=t.filter(n=>r.priceRanges.some(o=>{switch(o){case"under50":return n.price<50;case"50to100":return n.price>=50&&n.price<=100;case"over100":return n.price>100;default:return!0}}))),S){case"name":t.sort((n,o)=>n.name.localeCompare(o.name));break;case"price-low":t.sort((n,o)=>n.price-o.price);break;case"price-high":t.sort((n,o)=>o.price-n.price);break}l=t.map(n=>n.element),i=1,s&&s.length>=3?b(s,t.length):b("",0),v(),L(),w()}function v(){if(!c)return;c.innerHTML="";const e=(i-1)*p,t=e+p,s=l.slice(e,t);if(s.length===0){c.innerHTML='<div class="loading">No products found</div>';return}s.forEach(o=>{c.appendChild(o)}),c.querySelectorAll(".product-item__image-grid").forEach(o=>{o.addEventListener("error",function(){o.style.display="none",o.alt="Image not available"})})}function x(e,t){const s=[];if(t<=5)for(let o=1;o<=t;o++)s.push(o);else e<=3?s.push(1,2,3,"...",t):e>=t-2?s.push(1,"...",t-2,t-1,t):s.push(1,"...",e-1,e,e+1,"...",t);return s}function L(){if(!y)return;const e=Math.ceil(l.length/p);if(e===0){y.innerHTML="";return}const t=x(i,e);let s=`
    <button
      class="pagination-btn --icon-left-arrow-product"
      ${i===1?"disabled":""}
      onclick="changePage(${i-1})"
    ></button>
  `;t.forEach(n=>{n==="..."?s+='<span class="pagination-ellipsis --icon-dots"></span>':n===i?s+=`<span class="pagination-current">${n}</span>`:s+=`<span class="pagination-number" onclick="changePage(${n})">${n}</span>`}),s+=`
    <button
      class="pagination-btn --icon-right-arrow-product"
      ${i===e?"disabled":""}
      onclick="changePage(${i+1})"
    ></button>
  `,y.innerHTML=s}function w(){E&&(E.textContent=l.length)}function A(e){const t=Math.ceil(l.length/p);e<1||e>t||(i=e,v(),L(),c&&c.scrollIntoView({behavior:"smooth",block:"start"}))}function F(){const e=C();if(e.search){const t=document.querySelector(".search-form__input");t&&(t.value=e.search),d(e.search),B()}else v();M(),L(),w()}window.changePage=A,document.addEventListener("DOMContentLoaded",function(){(document.querySelector(".product-grid")||window.location.pathname.includes("product.html"))&&(g=Array.from(document.querySelectorAll("#productItems article[data-id]")),l=[...g],g=g.map(e=>e.cloneNode(!0)),l=[...g],F())});
